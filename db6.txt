Сосчитать количество клиентов, покупающих товар.

SELECT DISTINCT COUNT(Client) AS Count_Client
FROM Client

Сколько посредников поставляют товар для фирмы.

SELECT COUNT(Seller) AS Count_Seller
FROM Seller
WHERE Status LIKE 'посредник'

Вывести среднюю сумму сделки по проданному товару.

SELECT ROUND(AVG(CostUnit * Count), 2)
FROM ClientGoods


Посчитать на какую сумму было всего поставлено товара.

SELECT SUM(CostUnit * Count) AS TotalAmount
FROM SallerGoods;

Определите максимальное количество закупленного товара шт.(кг)

SELECT MAX(Count)
FROM ClientGoods;

Какая минимальная сумма покупки, на которую клиент сделал заказ.

SELECT MIN(CostUnit * Count) AS MinOrderAmount
FROM ClientGoods;

Посчитать на какую сумму было продано товара магазинам.

SELECT SUM(cg.CostUnit * cg.Count)
FROM Client c
JOIN ClientGoods cg ON c.INNClient = cg.INNClient
WHERE c.Status LIKE 'магазин';


Сосчитать общее количество видов закупленных фирмой вафель.

SELECT COUNT(Goods)
FROM SallerGoods
WHERE Goods LIKE 'Вафли%';

Выведите среднюю цену на растительное масло (закупочную).

Нет растительного масла

Определите сколько всего было продано килограмм яблок.

SELECT SUM(cg.Count)
FROM ClientGoods cg , SallerGoods sg
WHERE cg.IDParty  = sg.ID AND sg.Goods LIKE 'Яблоки%'

Определите какое количество картофеля закупили кафе.

SELECT SUM(cg.Count)
FROM Client c
JOIN ClientGoods cg ON c.INNClient = cg.INNClient
JOIN SallerGoods sg ON cg.ID = sg.ID
WHERE c.Status LIKE 'кафе' AND sg.Goods LIKE 'Картофель%'

Посчитать сколько клиентов купили перец черный молотый.

SELECT COUNT(DISTINCT c.Client)
FROM Client c
JOIN ClientGoods cg ON c.INNClient = cg.INNClient
JOIN SallerGoods sg ON cg.ID = sg.ID
WHERE sg.Goods = 'Перец черный молотый';

Определить сколько наименований товара было куплено у посредников.

SELECT COUNT(DISTINCT sg.Goods)
FROM SallerGoods sg
JOIN Seller s ON sg.INNSeller = s.INNSeller
WHERE s.Status LIKE 'посредник';

Определить минимальную цену за единицу проданного товара.

SELECT MIN(CostUnit)
FROM ClientGoods

Определите минимальную сумму на какую было закуплено товара.

SELECT MIN(CostUnit * Count)
FROM ClientGoods

Определить максимальную сумму за товар, проданный магазинам.

SELECT MAX(cg.CostUnit * cg.Count)
FROM ClientGoods cg
JOIN Client c ON cg.INNClient = c.INNClient
WHERE c.Status LIKE 'магазин'

Определить со сколькими фирмами сотрудничает данная фирма.

SELECT COUNT(DISTINCT c.INNClient) AS NumberOfClients
FROM Client c
JOIN ClientGoods cg ON c.INNClient = cg.INNClient
WHERE c.Status NOT LIKE 'посредник';


Определить минимальную сумму сделки по закупке товара у производителей.

SELECT MIN(cg.CostUnit * cg.Count) AS MinTransactionAmount
FROM ClientGoods cg
JOIN SallerGoods sg ON cg.ID = sg.ID
JOIN Seller s ON sg.INNSeller = s.INNSeller
WHERE s.Status LIKE 'производитель';


Определить среднюю цену за пачку чая при покупке.

SELECT ROUND(AVG(cg.CostUnit * cg.Count), 2)
FROM ClientGoods cg
JOIN SallerGoods sg ON cg.ID  = sg.ID
WHERE sg.Goods LIKE 'Чай%'

Определите максимальную сумму прибыли за товар, проданный посреднику.

SELECT MAX(cg.Count * cg.CostUnit)
FROM ClientGoods cg
JOIN Client c ON cg.INNClient = c.INNClient
WHERE c.Status LIKE 'посредник'

Определите минимальную прибыль за товар, купленный у посредника.

SELECT MIN(cg.Count * cg.CostUnit)
FROM ClientGoods cg
JOIN SallerGoods sg  ON cg.ID  = cg.ID
JOIN Seller s ON sg.INNSeller = s.INNSeller
WHERE s.Status LIKE 'посредник'

Какое количество наименований товара куплено у фирмы.



 Сколько в продаже видов печенья.

SELECT COUNT(DISTINCT Goods) AS Count_
FROM SallerGoods
WHERE Goods LIKE 'Печенье%'

Какая максимальная сумма покупки, на которую клиент сделал заказ.

SELECT MAX(CostUnit * Count)
FROM ClientGoods

 Определите среднюю прибыль от перепродажи масла.

SELECT AVG((cg.CostUnit - sg.CostUnit) * cg.Count)
FROM ClientGoods cg
JOIN SallerGoods sg ON cg.ID  = sg.ID
WHERE sg.Goods LIKE 'масло%'

Со сколькими посредниками сотрудничает фирма.

SELECT SUM(cnt) AS TotalIntermediaries
FROM (
    SELECT COUNT(c.Client) AS cnt
    FROM Client c
    WHERE c.Status LIKE 'посредник'

    UNION ALL

    SELECT COUNT(s.Seller) AS cnt
    FROM Seller s
    WHERE s.Status LIKE 'посредник'
) AS counts;















